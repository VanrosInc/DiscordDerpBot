using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace DiscordDerpBot.CommandProcessing
{
    public class CommandArgs
    {
        private List<string> args = new List<string>();

        public CommandArgs() { new CommandArgs(new string[] { }); }

        public CommandArgs(string[] argsx)
        {
            foreach (string s in argsx)
            {
                args.Add(s);
            }
        }

        /// <summary>
        /// Checks to see if there are no args.
        /// </summary>
        /// <returns>Whether there are args.</returns>
        public bool isEmpty()
        {
            if (args.Count == 0) return true;
            return false;
        }

        /// <summary>
        /// Gets the argument at the following position.
        /// </summary>
        /// <param name="pos"></param>
        /// <returns></returns>
        public string GetArgAtPosition(int pos)
        {
            return args[pos];
        }

        /// <summary>
        /// Checks if there is a switch anywhere in the arg string.
        /// </summary>
        /// <param name="switch_key">The swich key to check for.</param>
        /// <returns>Whether there is a switch value.</returns>
        public bool ContainsSwitch(string switch_key)
        {
            if (args.Contains($"-{switch_key}") || args.Contains($"/{switch_key}")) return true;
            return false;
        }

        /// <summary>
        /// Checks to see if the specified arg is anywhere in the argument stirng.
        /// </summary>
        /// <param name="arg">The arg to search for.</param>
        /// <returns>Whether the arg was found.</returns>
        public bool ContainsArg(string arg)
        {
            if (args.Contains(arg)) return true;
            return false;
        }

        /// <summary>
        /// Gets the index of the specified arg.
        /// </summary>
        /// <param name="arg">The arg to get the index of.</param>
        /// <returns>The index of the specified arg.</returns>
        public int GetIndexOfArg(String arg)
        {
            if (ContainsArg(arg))
            {
                var index = args.IndexOf(arg);
                return index;
            }
            return 0;
        }

        /// <summary>
        /// Gets the index of the swithc witht he following name.
        /// </summary>
        /// <param name="switch_key">The name of the switch key.</param>
        /// <returns>The index of the switch with the key.</returns>
        public int GetIndexOfSwitch(string switch_key)
        {
            if (ContainsSwitch(switch_key))
            {
                if (args.Contains($"-{switch_key}"))
                {
                    var index = args.IndexOf($"-{switch_key}");
                    return index;
                }
                else if (args.Contains($"/{switch_key}"))
                {
                    var index = args.IndexOf($"/{switch_key}");
                    return index;
                }
            }
            return 0;
        }

        /// <summary>
        /// Skips the argument at the following location.
        /// </summary>
        /// <param name="index">The index to split from.</param>
        /// <returns>A reformmated string array.</returns>
        public string[] Skip(int index)
        {
            var x = args.ToString();
            var l = x.Substring(index, x.Length);
            var s = l.Split(' ');
            var ls = new List<string>();
            foreach (string sx in s)
                ls.Add(sx);
            return ls.ToArray();
        }

        /// <summary>
        /// Skips the argument with the following name.
        /// </summary>
        /// <param name="arg">The string to skip from.</param>
        /// <returns>The newly formatted string only containing the data that was skipped from.</returns>
        public string[] Skip(string arg)
        {
            return Skip(GetIndexOfArg(arg));
        }

        public string RemoveSwitch(string value)
        {
            if (value.Contains('-'))
            {
                int index = value.IndexOf('-');
                string clean = (index < 0) ? value : value.Remove(index, 1);
            }
            return value;
        }
    }
}
